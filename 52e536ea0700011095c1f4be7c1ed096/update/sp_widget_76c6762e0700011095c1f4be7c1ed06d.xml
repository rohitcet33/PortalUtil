<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope,$rootScope,spUtil) {
  /* widget controller */
  var c = this;
	$rootScope.$on('pagination-data', function(event,data) {
		c.data.dataOptins=data;
   });
	
	$scope.$on('widget-filter-breadcrumbs.queryModified', function(e, newFilter){
		$scope.data.filter = newFilter;
		spUtil.update($scope).then(function(){
			$rootScope.$broadcast('send-pagination-data', c.data.dataOptins);
		});
	});
	
		$scope.headerClass =function (index){
		if(index>2)
			return "header1";
			else
			//return "header2"; 
			return "header1";
	}
	
};]]></client_script>
        <controller_as>c</controller_as>
        <css>#customers {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

#customers td, #customers th {
  border: 3px solid #000000;
  padding: 8px;
}

#customers tr:nth-child(even){background-color: #f2f2f2;}

#customers tr:hover {background-color: #ddd;}

.header1 {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  border: 1px solid black; 
   border-collapse: collapse;
  background-color: #074f6d;
  color: white;
}
.header2 {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  border: 1px solid black; 
   border-collapse: collapse;
  background-color: #cc3a74;
  color: white;
}
.drop-menu{
	padding-left: 17px;
}
.drop-menu:hover {
 cursor:pointer;
 background-color: #ddd;
}
th{
white-space: nowrap;
min-width: 72px;
text-align: center;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>Custom List</name>
        <option_schema>[{"hint":"incident","name":"table_name","section":"Data","label":"Table Name","type":"string"},{"hint":"active=true","name":"query","section":"Data","label":"Query","type":"string"},{"hint":"name,state","name":"fields","section":"Data","label":"Fields","type":"string"},{"name":"pagination","section":"Behavior","default_value":"false","label":"Pagination","type":"boolean"},{"name":"filter_breadcrumbs","section":"Behavior","default_value":"false","label":"Filter Breadcrumbs","type":"boolean"},{"hint":"State, Assignment Group","name":"table_header","section":"Data","label":"Table Header","type":"string"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	var table=options.table_name;
	var query=options.query;
	var arrayData=[];
	var fields=options.fields;
	var listFields=fields.split(',');
	data.listFields=listFields;
	var tableHeader=options.table_header;
	data.tableHeader=tableHeader.split(',')
	data.isPagination=options.pagination || false;
	data.isbreadcrumbs=options.filter_breadcrumbs||false;
	
	
	data.filter = data.filter ||(input && input.filter)
	if(data.filter || (input && input.filter)){
		query=query+'^'+data.filter;
	}
	var gr = new GlideRecord(table);
	gr.addEncodedQuery(query);
	gr.query();
	while(gr.next()){
		var obj={};
		for(var i=0;i<listFields.length;i++){
			obj[listFields[i]]=gr.getDisplayValue(listFields[i]);
		}
		arrayData.push(obj)
	}
	data.rec=arrayData;
	/* Pagination Start */
	data.dataOptins={
		total_record_row:arrayData.length,
		maxrecord:5,
		currentIndex:0
	};
	data.pagination=$sp.getWidget('pagination', data.dataOptins);
	/* Pagination End here*/
	var breadcrumbWidgetParams = {
		table: table,
		query: data.filter,
		enable_filter: true
	};
	data.filterBreadcrumbs = $sp.getWidget('widget-filter-breadcrumbs', breadcrumbWidgetParams);
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>rohit.kumar</sys_created_by>
        <sys_created_on>2021-11-29 03:27:10</sys_created_on>
        <sys_id>76c6762e0700011095c1f4be7c1ed06d</sys_id>
        <sys_mod_count>82</sys_mod_count>
        <sys_name>Custom List</sys_name>
        <sys_package display_value="Portal Util" source="x_26525_portal">52e536ea0700011095c1f4be7c1ed096</sys_package>
        <sys_policy/>
        <sys_scope display_value="Portal Util">52e536ea0700011095c1f4be7c1ed096</sys_scope>
        <sys_update_name>sp_widget_76c6762e0700011095c1f4be7c1ed06d</sys_update_name>
        <sys_updated_by>rohit.kumar</sys_updated_by>
        <sys_updated_on>2021-11-30 05:33:47</sys_updated_on>
        <template><![CDATA[<div>
<!-- your widget template -->
  <!--{{c.data.dataOptins}} -->
  <div class="filter-breadcrumbs" ng-if="data.isbreadcrumbs == 'true'">
	    		<sp-widget widget="data.filterBreadcrumbs"></sp-widget>
   </div>

  <table id="customers">
    <tr>
    <th ng-repeat="x in data.tableHeader track by $index " ng-class="headerClass($index)">{{x}}</th>
    </tr>
    
    <tr ng-repeat="c in data.rec | limitTo:c.data.dataOptins.maxrecord: c.data.dataOptins.currentIndex " ng-if="data.isPagination == 'true'">
      <td ng-repeat="cal in data.listFields track by $index ">
        <p>{{c[cal]}}</p>
      </td>
    </tr>
    
    <tr ng-repeat="c in data.rec" ng-if="data.isPagination != 'true'">
      <td ng-repeat="cal in data.listFields track by $index ">
        <p>{{c[cal]}}</p>
      </td>
    </tr>
    
  </table>
  <div ng-if="data.isPagination == 'true'">
    <sp-widget widget="data.pagination"></sp-widget>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
